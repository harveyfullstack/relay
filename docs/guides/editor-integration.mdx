---
title: "Editor Integration (ACP)"
description: "Integrate Agent Relay with code editors using the Agent Client Protocol"
icon: "code"
---

# Editor Integration with ACP

Agent Relay can be integrated with code editors like [Zed](https://zed.dev), [Neovim](https://neovim.io), and other editors that support the [Agent Client Protocol (ACP)](https://agentclientprotocol.com).

## What is ACP?

The **Agent Client Protocol** is an open standard (created by Zed Industries) that enables AI agents to integrate with code editors. Think of it as LSP (Language Server Protocol), but for AI coding agents.

ACP provides:
- Standardized communication between editors and AI agents
- Session management for conversations
- Tool permissions and file operations
- Streaming responses

## Architecture

The ACP bridge connects your editor to all your relay agents:

```
┌─────────────────┐     ACP (stdio)    ┌─────────────────┐
│   Zed Editor    │ ◄────────────────► │  relay-acp      │
│   (or other)    │   JSON-RPC 2.0     │  (bridge)       │
└─────────────────┘                    └────────┬────────┘
                                                │
                                       Relay Protocol
                                                │
                                       ┌────────▼────────┐
                                       │  Relay Daemon   │
                                       └────────┬────────┘
                                                │
                        ┌───────────────────────┼───────────────────────┐
                        │                       │                       │
                   Agent 1                 Agent 2                 Agent N
                   (Claude)                (Codex)                 (any CLI)
```

When you send a prompt from your editor:

1. The editor sends the prompt via ACP to the bridge
2. The bridge broadcasts to all connected relay agents
3. Agents respond through the relay daemon
4. The bridge streams responses back to the editor

## Quick Start (Zed)

### 1. Start the Daemon and Configure Zed

```bash
agent-relay up --zed
```

This starts the relay daemon and auto-configures Zed's `~/.config/zed/settings.json` with the correct paths for your workspace.

### 2. Spawn Some Agents

Create agents that will respond to editor prompts:

```bash
# Spawn a code review agent
agent-relay spawn Reviewer claude "Review code changes and suggest improvements"

# Spawn an architect agent
agent-relay spawn Architect claude "Help with system design and architecture decisions"
```

### 3. Start Chatting

Open Zed's Agent Panel with `Cmd+?` (macOS) or `Ctrl+?` (Windows/Linux), select **"Agent Relay"**, and start typing. You can:
- **Broadcast to all agents**: Just type your message
- **Target specific agents**: Use `@AgentName` (e.g., `@Reviewer check this code`)

## Run Relay Commands from Zed

From the Zed Agent Panel you can issue relay CLI-style commands directly (the bridge intercepts them, no shell required):

- `agent-relay spawn Reviewer claude "Review the current changes"`
- `agent-relay release Reviewer`
- `agent-relay agents` (lists connected agents)

Currently supported commands: spawn/create-agent, release, agents/who. All other messages are still broadcast to your connected agents. A quick help block is shown when a new conversation starts; type `agent-relay help` to see it again.

## Supported ACP Features

| Feature | Status | Notes |
|---------|--------|-------|
| Session creation | ✅ | New sessions supported |
| Prompt handling | ✅ | With streaming responses |
| Cancellation | ✅ | Abort in-flight prompts |
| Session loading | ❌ | Not yet supported |
| Tool calls | ❌ | Coming soon |
| File operations | ❌ | Use relay agents directly |

## Troubleshooting

### Bridge not connecting to daemon

Ensure the relay daemon is running:

```bash
agent-relay status
```

If not running, start it:

```bash
agent-relay up
```

### No responses from agents

Check if any agents are connected:

```bash
agent-relay who
```

If no agents are listed, spawn some:

```bash
agent-relay spawn Worker claude "Help with coding tasks"
```

### Debug logging

Enable debug output to see what's happening:

```bash
relay-acp --debug --name test-bridge
```

Debug logs go to stderr to avoid interfering with the ACP protocol on stdout.

## Best Practices

### 1. Use Specialized Agents

Instead of one general agent, spawn specialized agents:

```bash
# Code specialist
agent-relay spawn Coder claude "Write and modify code"

# Review specialist
agent-relay spawn Reviewer claude "Review code quality and security"

# Architecture specialist
agent-relay spawn Architect claude "Design systems and APIs"
```

### 2. Name Your Bridge

Use descriptive names to identify which editor is connected:

```bash
relay-acp --name "vscode-main"
relay-acp --name "zed-frontend"
```

### 3. Monitor with Dashboard

Use the relay dashboard to see all connected editors and agents:

```bash
agent-relay up --dashboard
```

Then open http://localhost:3888 to see the message flow.

## Comparison with Direct Integration

| Aspect | ACP Bridge | Direct PTY |
|--------|------------|------------|
| Multi-agent | ✅ All agents respond | Single agent per session |
| Editor support | ✅ Any ACP editor | CLI only |
| Response format | Streamed via ACP | Raw terminal output |
| Session management | ACP handles it | Manual |
| Setup complexity | Low | Medium |

The ACP bridge is ideal when you want your editor to access multiple relay agents simultaneously.

## Other Editors (Advanced)

For editors other than Zed, you'll need to install the ACP bridge package and configure your editor manually.

### Programmatic Usage

You can use the bridge programmatically in your own tools:

```typescript
import { RelayACPAgent } from '@agent-relay/acp-bridge';

const agent = new RelayACPAgent({
  agentName: 'my-custom-bridge',
  socketPath: '/tmp/relay-daemon.sock',
  debug: true,
  capabilities: {
    supportsSessionLoading: false,
  },
});

await agent.start();
```

#### Configuration Options

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `agentName` | string | `'relay-acp'` | Name used when connecting to relay daemon |
| `socketPath` | string | auto | Path to relay daemon socket |
| `debug` | boolean | `false` | Enable debug logging |
| `capabilities` | object | - | ACP capabilities to advertise |

### Installation

```bash
npm install -g @agent-relay/acp-bridge
```

Or build from source:

```bash
cd packages/acp-bridge
npm install
npm run build
npm link
```

### Neovim

Requires an ACP-compatible Neovim plugin (e.g., [acp.nvim](https://github.com/acp-nvim/acp.nvim)):

```lua
require('acp').setup({
  agents = {
    {
      name = "Agent Relay",
      command = "relay-acp",
      args = {
        "--name", "nvim-bridge",
        "--socket", "/path/to/your/project/.agent-relay/relay.sock"
      }
    }
  }
})
```

### Other ACP-Compatible Editors

For any editor that supports the [Agent Client Protocol](https://agentclientprotocol.com), configure it to run:

```bash
relay-acp --name my-editor-bridge --socket /path/to/.agent-relay/relay.sock
```

The bridge communicates via stdio using newline-delimited JSON (ACP protocol).

### Manual Zed Configuration

If you prefer not to use `--zed`, add this to `~/.config/zed/settings.json`:

```json
{
  "agent_servers": {
    "Agent Relay": {
      "type": "custom",
      "command": "relay-acp",
      "args": [
        "--name", "zed-bridge",
        "--socket", "/path/to/your/project/.agent-relay/relay.sock",
        "--debug"
      ],
      "env": {}
    }
  }
}
```

## Related

- [Messaging](/features/messaging) - How agent-to-agent messaging works
- [Spawning Agents](/features/spawning) - Creating and managing agents
- [Worker Orchestration](/guides/worker-orchestration) - Coordinating multiple agents
