{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://agentrelay.dev/schemas/inject-request.schema.json",
  "title": "Inject Request",
  "description": "JSON format sent to the relay-pty Unix socket for message injection. Socket path: /tmp/relay-pty-{agentName}.sock",
  "oneOf": [
    {
      "type": "object",
      "description": "Inject a message into the agent's PTY",
      "properties": {
        "type": {
          "type": "string",
          "const": "inject",
          "description": "Request type for message injection"
        },
        "id": {
          "type": "string",
          "description": "Unique message ID for tracking (used in acknowledgments)"
        },
        "from": {
          "type": "string",
          "description": "Sender name (displayed as 'Relay message from {from}')"
        },
        "body": {
          "type": "string",
          "description": "Message body to inject into the agent's terminal"
        },
        "priority": {
          "type": "integer",
          "default": 0,
          "description": "Priority level (lower = higher priority). Default is 0."
        }
      },
      "required": ["type", "id", "from", "body"],
      "additionalProperties": false
    },
    {
      "type": "object",
      "description": "Query agent status (idle detection, queue length)",
      "properties": {
        "type": {
          "type": "string",
          "const": "status",
          "description": "Request type for status query"
        }
      },
      "required": ["type"],
      "additionalProperties": false
    },
    {
      "type": "object",
      "description": "Request graceful shutdown of relay-pty",
      "properties": {
        "type": {
          "type": "string",
          "const": "shutdown",
          "description": "Request type for shutdown"
        }
      },
      "required": ["type"],
      "additionalProperties": false
    }
  ],
  "examples": [
    {
      "_comment": "Inject a message",
      "type": "inject",
      "id": "msg-abc123",
      "from": "Alice",
      "body": "Hello Bob, can you review PR #42?",
      "priority": 0
    },
    {
      "_comment": "High priority message",
      "type": "inject",
      "id": "msg-urgent-001",
      "from": "Lead",
      "body": "URGENT: Production is down, please investigate immediately",
      "priority": -1
    },
    {
      "_comment": "Query status",
      "type": "status"
    },
    {
      "_comment": "Request shutdown",
      "type": "shutdown"
    }
  ]
}
