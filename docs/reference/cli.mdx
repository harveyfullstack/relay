---
title: CLI Reference
description: Complete reference for all agent-relay CLI commands and options
---

# CLI Reference

The `agent-relay` CLI provides commands for managing the relay daemon, agents, and multi-project orchestration.

## Installation

```bash
npm install -g agent-relay
```

## Quick Reference

| Command | Description |
|---------|-------------|
| `agent-relay up` | Start daemon (add `--dashboard` for web UI) |
| `agent-relay down` | Stop the daemon |
| `agent-relay status` | Check daemon status |
| `agent-relay create-agent` | Wrap an agent with real-time messaging |
| `agent-relay spawn` | Spawn a new agent |
| `agent-relay release` | Release an agent |
| `agent-relay agents` | List connected agents |
| `agent-relay who` | Show active agents |
| `agent-relay read` | Read full message by ID |
| `agent-relay bridge` | Multi-project orchestration |
| `agent-relay cloud` | Cloud account commands |

---

## Core Commands

### agent-relay up

Start the relay daemon and web dashboard.

```bash
agent-relay up [options]
```

**Options:**

| Option | Description | Default |
|--------|-------------|---------|
| `--no-dashboard` | Disable the web dashboard | Dashboard enabled |
| `--port <port>` | Dashboard port number | `3888` |
| `--spawn` | Force spawn all agents from `teams.json` | Auto-detect |
| `--no-spawn` | Do not auto-spawn agents | Auto-detect |
| `--watch` | Auto-restart daemon on crash (supervisor mode) | Disabled |
| `--max-restarts <n>` | Max restarts in 60s before giving up | `5` |

**Examples:**

```bash
# Start with default settings
agent-relay up

# Start on custom port
agent-relay up --port 4000

# Start without dashboard
agent-relay up --no-dashboard

# Start in supervisor mode (auto-restart on crash)
agent-relay up --watch

# Auto-spawn agents from teams.json
agent-relay up --spawn
```

**Output:**
```
Project: /Users/you/myproject
Socket:  /tmp/relay/abc123/agent-relay.sock
Daemon started.
Dashboard: http://localhost:3888
Press Ctrl+C to stop.
```

---

### agent-relay down

Stop the running daemon.

```bash
agent-relay down
```

**Examples:**

```bash
agent-relay down
# Output: Stopped

# If not running
agent-relay down
# Output: Not running
```

---

### agent-relay status

Check the daemon status and list relay tmux sessions.

```bash
agent-relay status
```

**Example Output:**

```
Status: RUNNING
Socket: /tmp/relay/abc123/agent-relay.sock
Relay tmux sessions:
- relay-Dashboard (agent: Dashboard, cwd: /Users/you/myproject)
- relay-Worker1 (agent: Worker1, cwd: /Users/you/myproject)
```

---

### agent-relay create-agent

Wrap an AI CLI agent with real-time messaging capabilities.

```bash
agent-relay create-agent [options] <command...>
```

**Arguments:**

| Argument | Description |
|----------|-------------|
| `command...` | Command to wrap (e.g., `claude`, `codex`, `gemini`) |

**Options:**

| Option | Description | Default |
|--------|-------------|---------|
| `-n, --name <name>` | Agent name | Auto-generated |
| `-d, --debug` | Enable debug output | Disabled |
| `--prefix <pattern>` | Relay prefix pattern | `->relay:` |
| `--dashboard-port <port>` | Dashboard port for spawn/release API | Auto-detected |
| `--shadow <name>` | Spawn a shadow agent with this name | None |
| `--shadow-role <role>` | Shadow role: `reviewer`, `auditor`, or trigger list | `EXPLICIT_ASK` |
| `--skip-instructions` | Skip initial instruction injection | Disabled |

**Shadow Roles:**

| Role | Triggers |
|------|----------|
| `reviewer` | `CODE_WRITTEN`, `REVIEW_REQUEST`, `EXPLICIT_ASK` |
| `auditor` | `SESSION_END`, `EXPLICIT_ASK` |
| `active` | `ALL_MESSAGES` |

**Examples:**

```bash
# Basic usage with Claude
agent-relay create-agent claude

# With custom name
agent-relay create-agent -n MyAgent claude

# With shadow agent for code review
agent-relay create-agent -n Lead --shadow Reviewer --shadow-role reviewer claude

# With explicit triggers
agent-relay create-agent --shadow Auditor --shadow-role "SESSION_END,CODE_WRITTEN" claude

# Debug mode
agent-relay create-agent -d codex
```

---

## Agent Management

### agent-relay agents

List connected agents and spawned workers.

```bash
agent-relay agents [options]
```

**Options:**

| Option | Description |
|--------|-------------|
| `--all` | Include internal/CLI agents |
| `--remote` | Include agents from linked machines |
| `--json` | Output as JSON |

**Example Output:**

```
NAME            STATUS   CLI       TEAM
--------------------------------------------------
Dashboard       ONLINE   claude    -
Worker1         ONLINE   claude    backend
Worker2         ONLINE   codex     frontend

Commands:
  agent-relay agents:logs <name>   - View spawned agent output
  agent-relay agents:kill <name>   - Kill a spawned agent
```

---

### agent-relay who

Show currently active agents (online within last 30 seconds).

```bash
agent-relay who [options]
```

**Options:**

| Option | Description |
|--------|-------------|
| `--all` | Include internal/CLI agents |
| `--json` | Output as JSON |

**Example Output:**

```
NAME            STATUS   CLI       LAST SEEN
---------------------------------------------
Dashboard       ONLINE   claude    2s ago
Worker1         ONLINE   claude    5s ago
```

---

### agent-relay agents:logs

Show recent output from a spawned agent.

```bash
agent-relay agents:logs <name> [options]
```

**Arguments:**

| Argument | Description |
|----------|-------------|
| `name` | Agent name |

**Options:**

| Option | Description | Default |
|--------|-------------|---------|
| `-n, --lines <n>` | Number of lines to show | `50` |
| `-f, --follow` | Follow output (like `tail -f`) | Disabled |

**Examples:**

```bash
# Show last 50 lines
agent-relay agents:logs Worker1

# Show last 100 lines
agent-relay agents:logs Worker1 -n 100

# Follow output in real-time
agent-relay agents:logs Worker1 -f
```

---

### agent-relay agents:kill

Kill a spawned agent.

```bash
agent-relay agents:kill <name> [options]
```

**Options:**

| Option | Description |
|--------|-------------|
| `--force` | Skip graceful shutdown, kill immediately |

**Examples:**

```bash
# Graceful shutdown (SIGTERM, then SIGKILL)
agent-relay agents:kill Worker1

# Force kill immediately
agent-relay agents:kill Worker1 --force
```

---

### agent-relay read

Read the full content of a message by ID. Useful for truncated messages.

```bash
agent-relay read <id>
```

**Example:**

```bash
agent-relay read abc123def

# Output:
# From: Dashboard
# To: Worker1
# Time: 2024-01-15T10:30:00.000Z
# ---
# Full message content here...
```

---

## Multi-Project Orchestration

### agent-relay bridge

Bridge multiple projects for cross-project communication.

```bash
agent-relay bridge [projects...] [options]
```

**Arguments:**

| Argument | Description |
|----------|-------------|
| `projects...` | Project paths to bridge |

**Options:**

| Option | Description | Default |
|--------|-------------|---------|
| `--cli <tool>` | CLI tool override for all projects | Per-project config |
| `--architect [cli]` | Spawn an architect agent to coordinate | None |

**Examples:**

```bash
# Bridge two projects
agent-relay bridge ~/project1 ~/project2

# Bridge with Architect agent
agent-relay bridge ~/api ~/frontend --architect

# Use specific CLI for architect
agent-relay bridge ~/proj1 ~/proj2 --architect codex
```

**Cross-Project Messaging Format:**

```bash
# Message specific project lead
->relay:projectId:LeadName Message

# Broadcast to all leads
->relay:*:lead Message

# Broadcast to all agents in all projects
->relay:*:* Message
```

---

## Cloud Commands

### agent-relay cloud link

Link this machine to your Agent Relay Cloud account.

```bash
agent-relay cloud link [options]
```

**Options:**

| Option | Description | Default |
|--------|-------------|---------|
| `--name <name>` | Name for this machine | Hostname |
| `--cloud-url <url>` | Cloud API URL | `https://agent-relay.com` |

**Flow:**
1. Opens browser for authentication
2. Prompts for API key after authentication
3. Saves configuration locally

---

### agent-relay cloud unlink

Unlink this machine from Agent Relay Cloud.

```bash
agent-relay cloud unlink
```

---

### agent-relay cloud status

Show cloud sync status.

```bash
agent-relay cloud status
```

**Example Output:**

```
Cloud sync: Enabled

  Machine: my-laptop
  ID: my-laptop-a1b2c3d4
  Cloud URL: https://agent-relay.com
  Linked: 1/15/2024, 10:30:00 AM

  Daemon: Running
  Cloud connection: Online
```

---

### agent-relay cloud sync

Manually sync credentials from cloud.

```bash
agent-relay cloud sync
```

---

## Utility Commands

### agent-relay version

Show version information.

```bash
agent-relay version
# Output: agent-relay v1.6.0
```

### agent-relay update

Check for updates and optionally install.

```bash
agent-relay update [options]
```

**Options:**

| Option | Description |
|--------|-------------|
| `--check` | Only check for updates, do not install |

**Examples:**

```bash
# Check and install updates
agent-relay update

# Check only
agent-relay update --check
```

---

## Hidden Commands

These commands are available but hidden from `--help` (for internal/agent use):

| Command | Description |
|---------|-------------|
| `agent-relay history` | Show recent messages |
| `agent-relay spawn` | Spawn agent via dashboard API |
| `agent-relay release` | Release agent via dashboard API |
| `agent-relay gc` | Clean up orphaned tmux sessions |
| `agent-relay check-tmux` | Check tmux availability |
| `agent-relay trail` | Trajectory tracking (proxy to trail CLI) |

---

## Environment Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `AGENT_RELAY_DASHBOARD_PORT` | Default dashboard port | `3888` |
| `AGENT_RELAY_DATA_DIR` | Data directory for relay files | `~/.local/share/agent-relay` |
| `AGENT_RELAY_STORAGE_TYPE` | Storage type: `sqlite`, `memory`, `none` | `sqlite` |
| `AGENT_RELAY_STORAGE_PATH` | Path for SQLite database | Auto |
| `AGENT_RELAY_STORAGE_URL` | Connection URL for database | None |
| `AGENT_RELAY_CLOUD_URL` | Cloud API URL | `https://agent-relay.com` |
| `AGENT_RELAY_SUPERVISED` | Set by supervisor mode | Not set |

---

## Exit Codes

| Code | Meaning |
|------|---------|
| `0` | Success |
| `1` | General error |

---

## See Also

- [Protocol Reference](/reference/protocol) - Wire protocol specification
- [Configuration](/reference/configuration) - Configuration options
- [API Reference](/reference/api) - Programmatic API
